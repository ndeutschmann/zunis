
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>How to use a config file &#8212; ZüNIS 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon-v2.png"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to train without integrating" href="nointeg.html" />
    <link rel="prev" title="How-to’s" href="../how-tos.html" />
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

  </head><body>
  

    <div class="document">
<div class="documentwrapper">
    <div class="bodywrapper">
        

        <div class="body" role="main">
            <p id="mobilelink">
                <a href="#mobileanchor">
                    <i class="fa fa-caret-down" aria-hidden="true"></i> navigation links
                </a>
            </p>
            
  <div class="section" id="how-to-use-a-config-file">
<h1>How to use a config file<a class="headerlink" href="#how-to-use-a-config-file" title="Permalink to this headline">¶</a></h1>
<p>Config files can be used to specify arguments for an integrator, including an
instantiated optimizer. This is included in the <a class="reference internal" href="../../api/zunis.utils.config.html"><span class="doc">config</span></a> subpackage.
A default config file, integrator_config.yaml, is given there:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">flow</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pwquad</span>
<span class="nt">flow_options</span><span class="p">:</span>
<span class="nt">cell_params</span><span class="p">:</span>
  <span class="nt">d_hidden</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">256</span>
  <span class="nt">n_bins</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
  <span class="nt">n_hidden</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="nt">masking</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">iflow</span>
<span class="nt">masking_options</span><span class="p">:</span>
  <span class="nt">repetitions</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">loss</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variance</span>
<span class="nt">n_points_survey</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="nt">n_iter</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">trainer_options</span><span class="p">:</span>
<span class="nt">minibatch_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="nt">max_reloads</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">n_epochs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="nt">optim</span><span class="p">:</span>
  <span class="nt">optim_cls</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Adam</span>
  <span class="nt">optim_config</span><span class="p">:</span>
    <span class="nt">betas</span><span class="p">:</span> <span class="kt">!!python/tuple</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">0.9</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">0.999</span>
    <span class="nt">eps</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1.0e-08</span>
    <span class="nt">lr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">checkpoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="nt">checkpoint_on_cuda</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="nt">checkpoint_path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
<p>the settings specified in the config file are used for the setup of the trainer,
the integrator and the flow.
The flow option specifies which kind of flow to use in the coupling
cells (choices being “realnvp”, “pwlinear” or “pwquad”), as well as the geometry
of the underlying neural network and, in case of piecewise-linear or -quadratic
flows, the number of bins. It is also possible to choose either a “checkerboard”,
“maximal” or “iflow” masking strategy and define how many sets of coupling cells
should be used.
For the purpose of training, either a “variance” or “dkl” loss can be specified.
For the DKL loss, it is possible to also request the survey strategy “adaptive_dkl”.
n_iter refers to the number of iterations, whereas n_points_survey defines the
number of points used per iteration for the survey stage; the same can be defined
for the refine stage too.
Apart from this, the trainer options itself can be also defined - the size of
minibatches, the maximum number of how often the trainer is allowed to restore
from a checkpoint if an exception happens as well as how many epochs are used
during an iteration. If “checkpoint” is set to True, checkpoints are saved
(on the GPU if “checkpoint_on_cuda” is true), alternative checkpoints can be
also taken from a file if a path is given. Lastly, the optimizer settings itself
are specified, defining which algorithm to use as well as its parameters.</p>
<p>TODO: add code</p>
</div>



            <!-- Render the warning message if using meta tag `:todo:` -->
            
        </div>
        
    </div>
</div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">ZüNIS</a></h1>








<hr id="mobileanchor">

<p class="caption"><span class="caption-text">Library</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic-example.html">Basic example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../how-tos.html">How-to's</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to use a config file</a></li>
<li class="toctree-l2"><a class="reference internal" href="nointeg.html">How to train without integrating</a></li>
<li class="toctree-l2"><a class="reference internal" href="preeval.html">How to train on a pre-evaluated sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="sample.html">How to sample from a trained model</a></li>
<li class="toctree-l2"><a class="reference internal" href="Rd.html">How to integrate in R^d</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../background/nis.html">Neural Importance Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background/training.html">Training strategies</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../py-modindex.html">Module Hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Symbol Index</a></li>
</ul>
<p class="caption"><span class="caption-text">Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
</ul>



<p class="caption">
    <span class="caption-text">Sources</span>
</p>

<ul>
    
    <li class="toctree-l1"><a href="https://github.com/ndeutschmann/zunis/"><i class="fa fa-github" aria-hidden="true"></i> Github Repository</a></li>
    
</ul>


<p class="caption">
    <span class="caption-text">Navigation</span>
</p>
<ul class="local-nav">



    
    
    <li><a href="../how-tos.html"><i class="fa fa-arrow-up" aria-hidden="true"></i>&nbsp;How-to’s</a></li>
    
    
<!--    <ul>-->
        
        
        
        <li><a href="nointeg.html"><i class="fa fa-arrow-right" aria-hidden="true"></i>&nbsp;How to train without integrating</a></li>
        
<!--    </ul>-->
    

</ul><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../how-tos.html">How-to’s</a><ul>
      <li>Previous: <a href="../how-tos.html" title="previous chapter">How-to’s</a></li>
      <li>Next: <a href="nointeg.html" title="next chapter">How to train without integrating</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
      
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>